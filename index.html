<html>

<head>
    <title>Team Anaylsis</title>
    <script type="text/javascript" src="api-thebluealliance.js"></script>
    <script
			  src="https://code.jquery.com/jquery-3.2.1.min.js"
			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
			  crossorigin="anonymous"></script>
	<style>
		table {
    			font-family: arial, sans-serif;
	    		border-collapse: collapse;
    			width: 100%;
		}

		td, th {
    			border: 1px solid #dddddd;
    			text-align: left;
    			padding: 8px;
		}

		tr:nth-child(even) {
    			background-color: #dddddd;
		}
	</style>
</head>

<body>
  Year:
  <input type="text" id="yr">
  Event code:
  <input type="text" id="ecode">
  <input type="submit" onclick="autoGen()">
  <br>
  (2017waamv - Auburn Mountainview)(2017wasno - Glacier Peak)(2017pncmp - Cheney)
  <br>
  Note: May not work for previous years
	<table id="table">
    <thead id="th"></thead>
    <tbody id="tb"></tbody>
	</table>
	<script>
		var rankArray = [];
		var iteration = 0;
    var currentName = "team";
    var otherName = "team";
    var currentCode = "2017wasno";
    var autoGen = function() {
      var x = document.getElementById('yr');
      var y = document.getElementById('ecode');
      currentCode = x.value + y.value
      tba.event.rankings(currentCode, foo);
    };
    var foo = function (tba) {
      $('.remove').remove();
			$('<tr class="remove" id="header"><th>Rank</th><th>Number</th><th>Name</th><th>Match Points</th><th>Record (W-L-T)</th><th>Played</th><th>Ranking Score</th></tr>').appendTo('#th');
	    rankArray=[];
      for (var i = 1; i <= tba.length; i++) {
          rankArray.push(tba[i]);
      }
      iteration = 0;
      var checkIteration = function() {
        if (iteration < rankArray.length-1) {
          getNameForRank();
        }
      }
      var getNameForRank = function() {
        currentName = "frc" + rankArray[iteration][1];
        tba3.team.get(currentName, parseName);
      }
      var parseName = function(tbal) {
        otherName = tbal.nickname;
        $('<tr class="remove"><td>' + rankArray[iteration][0] + '</td><td>' + rankArray[iteration][1] + '</td><td>' + otherName + '</td><td>' + rankArray[iteration][3] + '</td><td>' + rankArray[iteration][8]  + '</td><td>' + rankArray[iteration][9] + '</td><td>' + rankArray[iteration][2] + '</td></tr>').appendTo('#tb');
        iteration = iteration + 1;
        checkIteration();
      }
      getNameForRank();
    }
	</script>

</body>

</html>
